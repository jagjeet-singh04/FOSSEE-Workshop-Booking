
{% extends 'workshop_app/base.html' %}

{% block title %}
  Profile Statistics
{% endblock %}

{% block extra %}
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
	<link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
	<style>
		.stats-toggle {
			display: flex;
			gap: 1rem;
			align-items: center;
			margin-bottom: 2rem;
		}
		.toggle-btn {
			border: none;
			background: #e9ecef;
			color: #333;
			padding: 0.7rem 1.5rem;
			border-radius: 30px;
			font-weight: 600;
			cursor: pointer;
			transition: background 0.2s, color 0.2s;
		}
		.toggle-btn.active {
			background: #0d6efd;
			color: #fff;
		}
		.stats-card {
			background: #fff;
			border-radius: 16px;
			box-shadow: 0 4px 24px rgba(0,0,0,0.08);
			padding: 2rem;
			margin-bottom: 2rem;
		}
		.table th, .table td {
			vertical-align: middle;
		}
		.table thead th {
			background: #f1f3f4;
			font-weight: 600;
		}
		.table-hover tbody tr:hover {
			background: #e9ecef;
		}
		@media (max-width: 576px) {
			.stats-card {
				padding: 1rem;
			}
			.toggle-btn {
				padding: 0.5rem 1rem;
				font-size: 0.95rem;
			}
		}
	</style>
	<script>
		function showStats(type) {
			if (type === 'instructor') {
				document.getElementById('instructor_data').style.display = 'table';
				document.getElementById('coordinator_data').style.display = 'none';
				document.getElementById('btn-instructor').classList.add('active');
				document.getElementById('btn-coordinator').classList.remove('active');
			} else {
				document.getElementById('instructor_data').style.display = 'none';
				document.getElementById('coordinator_data').style.display = 'table';
				document.getElementById('btn-instructor').classList.remove('active');
				document.getElementById('btn-coordinator').classList.add('active');
			}
		}
		window.onload = function() {
			showStats('instructor');
		};
	</script>
{% endblock %}

{% block content %}
	<div class="container">
		<div class="stats-card">
			<div class="stats-toggle mb-4">
				<button id="btn-instructor" class="toggle-btn active" onclick="showStats('instructor')">
					<span class="material-icons" style="vertical-align:middle;">school</span> Instructor Statistics
				</button>
				<button id="btn-coordinator" class="toggle-btn" onclick="showStats('coordinator')">
					<span class="material-icons" style="vertical-align:middle;">groups</span> Coordinator Statistics
				</button>
			</div>
			<!-- Instructor Data Table -->
			<div class="table-responsive">
				<table class="table table-hover align-middle" id="instructor_data" style="display: table;">
					<thead>
						<tr>
							<th>#</th>
							<th>Username</th>
							<th>Full Name</th>
							<th>Institute Name</th>
							<th>Phone Number</th>
							<th>Workshop Count</th>
						</tr>
					</thead>
					{% csrf_token %}
					<tbody>
					{% for profile_data in instructor_data %}
						<tr>
							<td>{{ forloop.counter}}</td>
							<td>{{ profile_data.profile.user}}</td>
							<td>{{ profile_data.profile.user.first_name}} {{ profile_data.profile.user.last_name}}</td>
							<td>{{ profile_data.profile.institute}}</td>
							<td>{{ profile_data.profile.phone_number}}</td>
							<td>{{ profile_data.count}}</td>
						</tr>
					{% endfor %}
					</tbody>
				</table>
			</div>
			<!-- Coordinator Data Table -->
			<div class="table-responsive">
				<table class="table table-hover align-middle" id="coordinator_data" style="display: none;">
					<thead>
						<tr>
							<th>#</th>
							<th>Name</th>
							<th>Institute Name</th>
							<th>Phone Number</th>
							<th>Registration Date</th>
							<th>Workshop Count</th>
						</tr>
					</thead>
					{% csrf_token %}
					<tbody>
					{% for profile_data in coordinator_data %}
						{% if profile_data.count > 0 %}
						<tr>
							<td>{{ forloop.counter }}</td>
							<td><a href="{{ URL_ROOT }}/view_comment_profile/{{ profile_data.profile.user.id }}">
								{{ profile_data.profile.user.get_full_name }}</a></td>
							<td>{{ profile_data.profile.institute}}</td>
							<td>{{ profile_data.profile.phone_number}}</td>
							<td>{{ profile_data.profile.user.date_joined | date}}</td>
							<td>{{ profile_data.count}}</td>
						</tr>
						{% endif %}
					{% endfor %}
					</tbody>
				</table>
			</div>
		</div>
	</div>
{% endblock %}
